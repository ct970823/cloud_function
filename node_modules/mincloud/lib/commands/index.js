'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _fs = require('fs');

var _fs2 = _interopRequireDefault(_fs);

var _path = require('path');

var _path2 = _interopRequireDefault(_path);

var _util = require('util');

var _util2 = _interopRequireDefault(_util);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

exports.default = function () {
  return _util2.default.promisify(_fs2.default.readdir)(__dirname).then(function (files) {
    return files.reduce(function (m, filename) {
      var joined = _path2.default.join(__dirname, filename);
      if (_fs2.default.statSync(joined).isDirectory() && _fs2.default.existsSync(_path2.default.join(joined, 'index.js'))) {
        m[filename] = require('./' + filename);
      } else {
        var ext = _path2.default.extname(filename);
        if (filename !== 'index.js' && ext === '.js' && !/\.(spec|test)\.js$/.test(filename)) {
          m[filename.replace(ext, '')] = require('./' + filename);
        }
      }
      return m;
    }, {});
  });
};